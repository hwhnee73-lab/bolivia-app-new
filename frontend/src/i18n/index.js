import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';

const STORAGE_KEY = 'locale';

const getDefaultLocale = () => {
  if (typeof localStorage !== 'undefined') {
    const saved = localStorage.getItem(STORAGE_KEY);
    if (saved) return saved;
  }
  const nav = typeof navigator !== 'undefined' ? navigator.language || 'en' : 'en';
  if (nav.startsWith('ko')) return 'ko';
  if (nav.startsWith('es')) return 'es';
  return 'en';
};

const resources = {
  en: {
    translation: {
      common: {
        loading: 'Loading...',
        error: 'An error occurred',
        errorShort: 'Error',
        errorWithMessage: 'Error: {{message}}',
        apply: 'Apply',
        cancel: 'Cancel',
        processing: 'Processing... ',
        prev: 'Previous',
        confirm: 'Confirm',
        ok: 'OK',
        saveChanges: 'Save Changes',
        register: 'Register',
        edit: 'Edit',
        delete: 'Delete',
        na: 'N/A',
      },
      nav: {
        menu: 'Menu',
        openMenu: 'Open menu',
        intro: 'Introduction',
        auth: 'Sign in',
        dashboard: 'Dashboard',
        finance: 'Finance & Reports',
        billingBatch: 'Billing Batch Upload',
        payment: 'Payments',
        reservation: 'Reservations',
        maintenance: 'Maintenance',
        community: 'Community',
        profile: 'Profile',
        userManagement: 'Users',
        residentManagement: 'Units & Residents',
        tasks: 'Tasks',
        reservationApproval: 'Reservations Approval',
        loginGoogle: 'Sign in with Google',
        communication: 'AI Announcements',
      },
      finance: {
        incomes: 'Total Incomes',
        expenses: 'Total Expenses',
        outstanding: 'Outstanding',
        trend: 'Income/Expense Trend',
        expenseShareRecent: 'Expense Share (Latest Month)',
        filters: { from: 'From (YYYY-MM)', to: 'To (YYYY-MM)', category: 'Category (Expenses)' },
        sections: { incomesMonthly: 'Incomes (Monthly)', expensesMonthItem: 'Expenses (Month/Item)', delinquencyRange: 'Delinquency (Range)' },
        table: { month: 'Month', item: 'Item', total: 'Total', billed: 'Billed', paid: 'Paid', outstanding: 'Outstanding', rate: 'Rate' },
        actions: { downloadCsv: 'Download CSV', downloadPdf: 'Download PDF' },
        errors: { loadFailed: 'Failed to load data.', applyFilterFailed: 'Failed to apply filter.' },
      },
      billing: {
        steps: { upload: 'Upload', preview: 'Validate Preview', confirm: 'Confirm' },
        fileLabel: 'CSV or XLSX file',
        columnsHelp: 'Columns: building_number, unit_number, bill_month(YYYY-MM), total_amount, due_date(YYYY-MM-DD), status',
        actions: {
          upload: 'Upload',
          downloadSample: 'Download CSV Sample',
          reset: 'Start Over',
        },
        preview: {
          totalRows: 'Total {{count}} rows',
          valid: 'Valid {{count}}',
          invalid: 'Invalid {{count}}',
          token: 'Token: {{token}}',
          invalidNote: 'There are invalid rows; confirmation is disabled.',
        },
        table: {
          row: 'Row', building: 'Bldg', unit: 'Unit', billMonth: 'Bill Month', amount: 'Amount', dueDate: 'Due Date', status: 'Status', validation: 'Validation',
        },
        result: { title: 'Confirmation Result', summary: '{{total}} total, {{upserted}} processed, {{skipped}} skipped' },
        errors: {
          selectFile: 'Please select a file.',
          uploadFailed: 'Upload failed',
          uploadError: 'Error during upload',
          missingToken: 'Missing validation token. Please upload again.',
          confirmFailed: 'Confirmation failed',
          confirmError: 'Error during confirmation',
        },
        success: { confirmed: 'Batch confirmation completed' },
      },
      communication: {
        title: '✨ Draft Announcements with AI',
        aiSummaryButton: 'AI Summary (Demo)',
        summaryModalTitle: 'Task Summary (Demo)',
        aiDisabled: 'AI integration is disabled in this environment.',
        defaultTitle: 'Important Announcement',
        generating: '✨ AI is drafting your announcement...',
        generated: 'Draft ready! Please review and edit if needed.',
        form: {
          promptLabel: 'Key Announcement Content',
          promptPlaceholder: 'e.g., Elevator maintenance on Aug 1',
          titleLabel: 'Announcement Title',
          titlePlaceholder: 'The generated title will appear here.',
          contentLabel: 'Announcement Content',
          contentPlaceholder: 'The generated announcement content will appear here.',
        },
        actions: {
          generate: '✨ Generate AI Draft',
          generating: 'Drafting...',
          publishAll: 'Send to all residents',
          publishing: 'Publishing...',
        },
        errors: {
          missingPrompt: 'Please enter the key content for the announcement.',
          emptyTitleContent: 'Title and content cannot be empty.',
          publishFailed: 'Failed to publish announcement.',
        },
        success: { published: 'The announcement has been published successfully.' },
      },
      reservations: {
        title: 'Reservation Approval Management',
        loading: 'Loading reservations...',
        table: { requester: 'Requester', facility: 'Facility', date: 'Reservation Date', status: 'Status', actions: 'Actions' },
        actions: { approve: 'Approve', reject: 'Reject' },
        errors: { loadFailed: 'Failed to load reservations.', updateFailed: 'Failed to update status.' },
        success: { marked: 'Reservation marked as {{status}}.' },
      },
      bills: {
        title: 'Pending Payments Management (Invoices)',
        actions: { new: 'Register New Invoice' },
        form: { editTitle: 'Edit Invoice', newTitle: 'Register New Invoice' },
        table: { unit: 'Unit', month: 'Month', amount: 'Amount', status: 'Status', actions: 'Actions' },
        confirmDelete: 'Are you sure you want to delete this invoice?',
        errors: { loadFailed: 'Failed to load invoices.', deleteFailed: 'Failed to delete invoice.', operationFailed: 'Operation failed.' },
        success: { deleted: 'The invoice has been deleted.', updated: 'The invoice has been updated.', created: 'A new invoice has been registered.' },
      },
      users: {
        title: 'User Management',
        actions: { new: 'New Registration' },
        form: { editTitle: 'Edit User Information', newTitle: 'Register New User' },
        table: { name: 'Name', sessionId: 'Session ID', role: 'Role', status: 'Status', actions: 'Actions' },
        confirmDelete: 'Are you sure you want to delete this user?',
        errors: { loadFailed: 'Failed to load users.', deleteFailed: 'Failed to delete user.', operationFailed: 'Operation failed.' },
        success: { deleted: 'The user has been deleted.', updated: 'User information has been updated.', created: 'A new user has been registered.' },
      },
      tasks: {
        title: 'Task & Maintenance Management',
        actions: { new: 'Register New Case' },
        form: { editTitle: 'Edit Request', newTitle: 'Register New Case' },
        table: { requester: 'Requester', type: 'Type', description: 'Description', status: 'Status', actions: 'Actions' },
        confirmDelete: 'Are you sure you want to delete this request?',
        errors: { loadFailed: 'Failed to load requests.', deleteFailed: 'Failed to delete request.', operationFailed: 'Operation failed.' },
        success: { deleted: 'The request has been deleted.', updated: 'The request has been updated.', created: 'A new request has been registered.' },
      },
      dashboard: {
        greeting: 'Hello,',
        dueNotice: 'Outstanding Maintenance Fee: {{amount}}',
      },
      community: {
        title: 'Community',
        actions: { newPostPlus: '+ Create New Post', publish: 'Publish' },
        form: { newTitle: 'New Post', titlePlaceholder: 'Title', contentPlaceholder: 'Write your content here.' },
        list: { title: 'Posts', author: 'Author', category: 'Category' },
        errors: { loadFailed: 'Failed to load posts.', createFailed: 'Failed to create post.' },
        success: { created: 'The post has been created.' },
      },
      maintenance: {
        title: 'Issue Reports & Maintenance',
        actions: { newReportPlus: '+ Report New Issue', submit: 'Submit Report' },
        form: { newTitle: 'Report New Issue', typeLabel: 'Issue Type', detailLabel: 'Detailed Description', detailPlaceholder: 'Describe the issue in detail.' },
        list: { title: 'My Requests Status' },
        errors: { loadFailed: 'Failed to load requests.', createFailed: 'Failed to create request.' },
        success: { received: 'Your maintenance request has been received.' },
      },
      payment: {
        title: 'Payments & Billing',
        loadingBills: 'Loading bills...',
        due: 'Due',
        detailTitle: 'Bill Detail',
        table: { month: 'Bill Month', status: 'Status', item: 'Item', amount: 'Amount', total: 'Total' },
        actions: { detail: 'Detail', receipt: 'Receipt', mockPay: 'Pay (Mock)', receiptPdf: 'Receipt PDF' },
        errors: { loadBillsFailed: 'Failed to load bills.' },
        success: { mockPaid: 'Mock payment completed.' },
      },
      profile: {
        title: 'Profile & Settings',
        sections: { accountInfo: 'Account Information', unitInfo: 'Unit Information' },
        info: { username: 'Name', sessionEmail: 'Session Email', role: 'Role' },
        form: { username: 'Name', email: 'Email' },
        actions: { save: 'Save', saving: 'Saving...', logout: 'Log Out' },
        errors: { saveFailed: 'Failed to save profile.' },
        success: { updated: 'Profile updated successfully.' },
        unit: { building: 'Building', unit: 'Apartment' },
      },
      reservation: {
        title: 'Common Areas Reservation',
        availableFacilities: 'Available Facilities',
        myReservations: 'My Reservations',
        actions: { reserve: 'Reserve', request: 'Request Reservation', cancel: 'Cancel Reservation' },
        modal: { title: 'Reserve {{name}}', selectDate: 'Select Date', selectTime: 'Select Time', unavailable: 'Unavailable', availabilityNote: 'Availability based on your reservations. It may vary.' },
        errors: { loadFailed: 'Failed to load reservation data.', selectDate: 'Please select a date.', createFailed: 'Failed to create reservation.', cancelFailed: 'Failed to cancel reservation.' },
        success: { requested: 'Reservation request for {{name}} has been sent.', canceled: 'Reservation has been canceled.' },
        confirmCancel: 'Are you sure you want to cancel this reservation?',
      },
    },
  },
  ko: {
    translation: {
      common: {
        loading: '로딩 중입니다...',
        error: '오류가 발생했습니다',
        errorShort: '오류',
        errorWithMessage: '오류: {{message}}',
        apply: '적용',
        cancel: '취소',
        processing: '처리 중...',
        prev: '이전',
        confirm: '확정',
        ok: '확인',
        saveChanges: '변경사항 저장',
        register: '등록',
        edit: '수정',
        delete: '삭제',
        na: '해당 없음',
      },
      nav: {
        menu: '메뉴',
        openMenu: '메뉴 열기',
        intro: '소개',
        auth: '로그인',
        dashboard: '대시보드',
        finance: '재무/리포트',
        billingBatch: '일괄 청구 업로드',
        payment: '결제',
        reservation: '예약',
        maintenance: '유지보수',
        community: '커뮤니티',
        profile: '프로필',
        userManagement: '사용자',
        residentManagement: '세대/입주민',
        tasks: '작업',
        reservationApproval: '예약 승인',
        loginGoogle: '구글로 로그인',
        communication: 'AI 공지',
      },
      finance: {
        incomes: '총 수입',
        expenses: '총 지출',
        outstanding: '미납 합계',
        trend: '수입/지출 추이',
        expenseShareRecent: '지출 비중 (최근월)',
        filters: { from: '시작 (YYYY-MM)', to: '종료 (YYYY-MM)', category: '카테고리(지출)' },
        sections: { incomesMonthly: '수입 (월별)', expensesMonthItem: '지출 (월/항목)', delinquencyRange: '연체/미납 (기간)' },
        table: { month: '월', item: '항목', total: '합계', billed: '청구', paid: '납부', outstanding: '미납', rate: '연체율' },
        actions: { downloadCsv: 'CSV 다운로드', downloadPdf: 'PDF 다운로드' },
        errors: { loadFailed: '데이터를 불러오지 못했습니다.', applyFilterFailed: '필터 적용에 실패했습니다.' },
      },
      billing: {
        steps: { upload: '업로드', preview: '검증 미리보기', confirm: '확정' },
        fileLabel: 'CSV 또는 XLSX 파일',
        columnsHelp: '컬럼: building_number, unit_number, bill_month(YYYY-MM), total_amount, due_date(YYYY-MM-DD), status',
        actions: {
          upload: '업로드',
          downloadSample: 'CSV 샘플 다운로드',
          reset: '새로 시작',
        },
        preview: {
          totalRows: '총 {{count}}행',
          valid: '유효 {{count}}',
          invalid: '무효 {{count}}',
          token: '토큰: {{token}}',
          invalidNote: '무효 행이 있어 확정이 비활성화되었습니다.',
        },
        table: {
          row: '행', building: '동', unit: '호', billMonth: '청구월', amount: '금액', dueDate: '마감일', status: '상태', validation: '검증',
        },
        result: { title: '업로드 확정 결과', summary: '총 {{total}}건 중 {{upserted}}건 처리, {{skipped}}건 건너뜀' },
        errors: {
          selectFile: '파일을 선택하세요.',
          uploadFailed: '업로드 실패',
          uploadError: '업로드 중 오류',
          missingToken: '검증 토큰이 없습니다. 다시 업로드하세요.',
          confirmFailed: '확정 실패',
          confirmError: '확정 중 오류',
        },
        success: { confirmed: '업로드 확정 완료' },
      },
      communication: {
        title: '✨ AI로 공지 작성',
        aiSummaryButton: 'AI 요약 (데모)',
        summaryModalTitle: '작업 요약 (데모)',
        aiDisabled: '이 환경에서는 AI 연동이 비활성화되어 있습니다.',
        defaultTitle: '중요 공지',
        generating: '✨ AI가 공지를 작성 중입니다...',
        generated: '작성 완료! 검토 후 필요 시 수정하세요.',
        form: {
          promptLabel: '공지 핵심 내용',
          promptPlaceholder: '예: 8월 1일 엘리베이터 정기 점검',
          titleLabel: '공지 제목',
          titlePlaceholder: '생성된 제목이 여기에 표시됩니다.',
          contentLabel: '공지 내용',
          contentPlaceholder: '생성된 공지 내용이 여기에 표시됩니다.',
        },
        actions: {
          generate: '✨ AI 초안 작성',
          generating: '작성 중...',
          publishAll: '모든 입주민에게 보내기',
          publishing: '발송 중...',
        },
        errors: {
          missingPrompt: '공지의 핵심 내용을 입력하세요.',
          emptyTitleContent: '제목과 내용을 입력하세요.',
          publishFailed: '공지 게시에 실패했습니다.',
        },
        success: { published: '공지가 성공적으로 게시되었습니다.' },
      },
      reservations: {
        title: '예약 승인 관리',
        loading: '예약을 불러오는 중...',
        table: { requester: '신청자', facility: '시설', date: '예약 일시', status: '상태', actions: '작업' },
        actions: { approve: '승인', reject: '거절' },
        errors: { loadFailed: '예약 목록을 불러오지 못했습니다.', updateFailed: '상태를 업데이트하지 못했습니다.' },
        success: { marked: '예약이 {{status}} 상태로 표시되었습니다.' },
      },
      bills: {
        title: '미납 청구 관리 (청구서)',
        actions: { new: '새 청구서 등록' },
        form: { editTitle: '청구서 수정', newTitle: '새 청구서 등록' },
        table: { unit: '세대', month: '월', amount: '금액', status: '상태', actions: '작업' },
        confirmDelete: '이 청구서를 삭제하시겠습니까?',
        errors: { loadFailed: '청구서를 불러오지 못했습니다.', deleteFailed: '청구서를 삭제하지 못했습니다.', operationFailed: '작업에 실패했습니다.' },
        success: { deleted: '청구서가 삭제되었습니다.', updated: '청구서가 수정되었습니다.', created: '새 청구서가 등록되었습니다.' },
      },
      users: {
        title: '사용자 관리',
        actions: { new: '새 사용자 등록' },
        form: { editTitle: '사용자 정보 수정', newTitle: '새 사용자 등록' },
        table: { name: '이름', sessionId: '세션 ID', role: '역할', status: '상태', actions: '작업' },
        confirmDelete: '이 사용자를 삭제하시겠습니까?',
        errors: { loadFailed: '사용자 목록을 불러오지 못했습니다.', deleteFailed: '사용자를 삭제하지 못했습니다.', operationFailed: '작업에 실패했습니다.' },
        success: { deleted: '사용자가 삭제되었습니다.', updated: '사용자 정보가 수정되었습니다.', created: '새 사용자가 등록되었습니다.' },
      },
      tasks: {
        title: '작업/유지보수 관리',
        actions: { new: '새 접수 등록' },
        form: { editTitle: '요청 수정', newTitle: '새 접수 등록' },
        table: { requester: '신청자', type: '유형', description: '설명', status: '상태', actions: '작업' },
        confirmDelete: '이 요청을 삭제하시겠습니까?',
        errors: { loadFailed: '요청 목록을 불러오지 못했습니다.', deleteFailed: '요청을 삭제하지 못했습니다.', operationFailed: '작업에 실패했습니다.' },
        success: { deleted: '요청이 삭제되었습니다.', updated: '요청이 수정되었습니다.', created: '새 요청이 등록되었습니다.' },
      },
      dashboard: {
        greeting: '안녕하세요,',
        dueNotice: '미납 관리비: {{amount}}',
      },
      community: {
        title: '커뮤니티',
        actions: { newPostPlus: '+ 새 글 작성', publish: '게시' },
        form: { newTitle: '새 글', titlePlaceholder: '제목', contentPlaceholder: '내용을 입력하세요.' },
        list: { title: '게시글 목록', author: '작성자', category: '분류' },
        errors: { loadFailed: '게시글을 불러오지 못했습니다.', createFailed: '게시글 등록 실패' },
        success: { created: '게시글이 등록되었습니다.' },
      },
      maintenance: {
        title: '문제 신고 및 유지보수',
        actions: { newReportPlus: '+ 새 문제 신고', submit: '신고 제출' },
        form: { newTitle: '새 문제 신고', typeLabel: '문제 유형', detailLabel: '상세 설명', detailPlaceholder: '문제를 자세히 작성하세요.' },
        list: { title: '내 요청 상태' },
        errors: { loadFailed: '요청 목록을 불러오지 못했습니다.', createFailed: '요청 등록 실패' },
        success: { received: '유지보수 요청이 접수되었습니다.' },
      },
      payment: {
        title: '결제 및 청구',
        loadingBills: '청구 정보를 불러오는 중...',
        due: '마감',
        detailTitle: '청구 상세',
        table: { month: '청구월', status: '상태', item: '항목', amount: '금액', total: '합계' },
        actions: { detail: '상세', receipt: '영수증', mockPay: '결제 (모의)', receiptPdf: '영수증 PDF' },
        errors: { loadBillsFailed: '청구서를 불러오지 못했습니다.' },
        success: { mockPaid: '모의 결제가 완료되었습니다.' },
      },
      profile: {
        title: '프로필 및 설정',
        sections: { accountInfo: '계정 정보', unitInfo: '세대 정보' },
        info: { username: '이름', sessionEmail: '세션 이메일', role: '역할' },
        form: { username: '이름', email: '이메일' },
        actions: { save: '저장', saving: '저장 중...', logout: '로그아웃' },
        errors: { saveFailed: '프로필 저장 실패' },
        success: { updated: '프로필이 업데이트되었습니다.' },
        unit: { building: '동', unit: '호' },
      },
      reservation: {
        title: '공용시설 예약',
        availableFacilities: '이용 가능한 시설',
        myReservations: '나의 예약',
        actions: { reserve: '예약', request: '예약 요청', cancel: '예약 취소' },
        modal: { title: '{{name}} 예약', selectDate: '날짜 선택', selectTime: '시간 선택', unavailable: '불가', availabilityNote: '사용자의 예약 기준으로 표시됩니다. 변동될 수 있습니다.' },
        errors: { loadFailed: '예약 데이터를 불러오지 못했습니다.', selectDate: '날짜를 선택하세요.', createFailed: '예약 생성 실패', cancelFailed: '예약 취소 실패' },
        success: { requested: '{{name}} 예약 요청이 전송되었습니다.', canceled: '예약이 취소되었습니다.' },
        confirmCancel: '이 예약을 취소하시겠습니까?',
      },
    },
  },
  es: {
    translation: {
      common: {
        loading: 'Cargando...',
        error: 'Ha ocurrido un error',
        errorShort: 'Error',
        errorWithMessage: 'Error: {{message}}',
        apply: 'Aplicar',
        cancel: 'Cancelar',
        processing: 'Procesando...',
        prev: 'Anterior',
        confirm: 'Confirmar',
        ok: 'OK',
        saveChanges: 'Guardar cambios',
        register: 'Registrar',
        edit: 'Editar',
        delete: 'Eliminar',
        na: 'N/D',
      },
      nav: {
        menu: 'Menú',
        openMenu: 'Abrir menú',
        intro: 'Introducción',
        auth: 'Iniciar sesión',
        dashboard: 'Panel',
        finance: 'Finanzas e Informes',
        billingBatch: 'Carga Masiva de Facturas',
        payment: 'Pagos',
        reservation: 'Reservas',
        maintenance: 'Mantenimiento',
        community: 'Comunidad',
        profile: 'Perfil',
        userManagement: 'Usuarios',
        residentManagement: 'Residentes y Unidades',
        tasks: 'Tareas',
        reservationApproval: 'Aprobación de Reservas',
        loginGoogle: 'Entrar con Google',
        communication: 'Anuncios con IA',
      },
      finance: {
        incomes: 'Ingresos Totales',
        expenses: 'Gastos Totales',
        outstanding: 'Total Pendiente',
        trend: 'Tendencia de Ingresos/Gastos',
        expenseShareRecent: 'Distribución de Gastos (Último mes)',
        filters: { from: 'Desde (AAAA-MM)', to: 'Hasta (AAAA-MM)', category: 'Categoría (Gastos)' },
        sections: { incomesMonthly: 'Ingresos (Mensual)', expensesMonthItem: 'Gastos (Mes/Ítem)', delinquencyRange: 'Mora (Periodo)' },
        table: { month: 'Mes', item: 'Ítem', total: 'Total', billed: 'Facturado', paid: 'Pagado', outstanding: 'Pendiente', rate: 'Tasa' },
        actions: { downloadCsv: 'Descargar CSV', downloadPdf: 'Descargar PDF' },
        errors: { loadFailed: 'No se pudieron cargar los datos.', applyFilterFailed: 'No se pudo aplicar el filtro.' },
      },
      billing: {
        steps: { upload: 'Subir', preview: 'Vista previa de validación', confirm: 'Confirmar' },
        fileLabel: 'Archivo CSV o XLSX',
        columnsHelp: 'Columnas: building_number, unit_number, bill_month(YYYY-MM), total_amount, due_date(YYYY-MM-DD), status',
        actions: {
          upload: 'Subir',
          downloadSample: 'Descargar muestra CSV',
          reset: 'Comenzar de nuevo',
        },
        preview: {
          totalRows: 'Total {{count}} filas',
          valid: 'Válidas {{count}}',
          invalid: 'Inválidas {{count}}',
          token: 'Token: {{token}}',
          invalidNote: 'Hay filas inválidas; la confirmación está deshabilitada.',
        },
        table: {
          row: 'Fila', building: 'Edif', unit: 'Unidad', billMonth: 'Mes de cobro', amount: 'Monto', dueDate: 'Vencimiento', status: 'Estado', validation: 'Validación',
        },
        result: { title: 'Resultado de Confirmación', summary: '{{total}} en total, {{upserted}} procesadas, {{skipped}} omitidas' },
        errors: {
          selectFile: 'Por favor seleccione un archivo.',
          uploadFailed: 'Fallo la subida',
          uploadError: 'Error durante la subida',
          missingToken: 'Falta el token de validación. Vuelva a subir.',
          confirmFailed: 'Fallo la confirmación',
          confirmError: 'Error durante la confirmación',
        },
        success: { confirmed: 'Confirmación de carga completada' },
      },
      communication: {
        title: '✨ Redactar Anuncios con IA',
        aiSummaryButton: 'Resumen con IA (Demo)',
        summaryModalTitle: 'Resumen de Tareas (Demo)',
        aiDisabled: 'La integración de IA está desactivada en este entorno.',
        defaultTitle: 'Anuncio Importante',
        generating: '✨ La IA está redactando el anuncio...',
        generated: '¡Redacción completada! Revise y edite si es necesario.',
        form: {
          promptLabel: 'Contenido Clave del Anuncio',
          promptPlaceholder: 'Ej.: Inspección del ascensor el 1 de agosto',
          titleLabel: 'Título del Anuncio',
          titlePlaceholder: 'El título generado aparecerá aquí.',
          contentLabel: 'Contenido del Anuncio',
          contentPlaceholder: 'El contenido generado por la IA aparecerá aquí.',
        },
        actions: {
          generate: '✨ Redactar borrador con IA',
          generating: 'Redactando...',
          publishAll: 'Enviar a todos los residentes',
          publishing: 'Publicando...',
        },
        errors: {
          missingPrompt: 'Por favor, ingrese el contenido clave del anuncio.',
          emptyTitleContent: 'El título y el contenido no pueden estar vacíos.',
          publishFailed: 'Falló la publicación del anuncio.',
        },
        success: { published: 'El anuncio ha sido publicado exitosamente.' },
      },
      reservations: {
        title: 'Gestión de Aprobación de Reservas',
        loading: 'Cargando reservas...',
        table: { requester: 'Solicitante', facility: 'Instalación', date: 'Fecha de Reserva', status: 'Estado', actions: 'Acciones' },
        actions: { approve: 'Aprobar', reject: 'Rechazar' },
        errors: { loadFailed: 'No se pudo cargar la lista de reservas.', updateFailed: 'No se pudo actualizar el estado.' },
        success: { marked: 'La reserva ha sido marcada como {{status}}.' },
      },
      bills: {
        title: 'Gestión de Pagos Pendientes (Facturas)',
        actions: { new: 'Registrar Nueva Factura' },
        form: { editTitle: 'Editar Factura', newTitle: 'Registrar Nueva Factura' },
        table: { unit: 'Unidad', month: 'Mes', amount: 'Monto', status: 'Estado', actions: 'Acciones' },
        confirmDelete: '¿Realmente desea eliminar esta factura?',
        errors: { loadFailed: 'No se pudo cargar la lista de facturas.', deleteFailed: 'No se pudo eliminar la factura.', operationFailed: 'La operación falló.' },
        success: { deleted: 'La factura ha sido eliminada.', updated: 'La factura ha sido actualizada.', created: 'Se ha registrado una nueva factura.' },
      },
      users: {
        title: 'Gestión de Usuarios',
        actions: { new: 'Nuevo Registro' },
        form: { editTitle: 'Editar Información de Usuario', newTitle: 'Registrar Nuevo Usuario' },
        table: { name: 'Nombre', sessionId: 'ID de Sesión', role: 'Rol', status: 'Estado', actions: 'Acciones' },
        confirmDelete: '¿Realmente desea eliminar este usuario?',
        errors: { loadFailed: 'No se pudo cargar la lista de usuarios.', deleteFailed: 'No se pudo eliminar el usuario.', operationFailed: 'La operación falló.' },
        success: { deleted: 'El usuario ha sido eliminado.', updated: 'La información del usuario ha sido actualizada.', created: 'Se ha registrado un nuevo usuario.' },
      },
      tasks: {
        title: 'Gestión de Tareas y Mantenimiento',
        actions: { new: 'Registrar Nuevo Caso' },
        form: { editTitle: 'Editar Solicitud', newTitle: 'Registrar Nuevo Caso' },
        table: { requester: 'Solicitante', type: 'Tipo', description: 'Descripción', status: 'Estado', actions: 'Acciones' },
        confirmDelete: '¿Realmente desea eliminar esta solicitud?',
        errors: { loadFailed: 'No se pudo cargar la lista de solicitudes.', deleteFailed: 'No se pudo eliminar la solicitud.', operationFailed: 'La operación falló.' },
        success: { deleted: 'La solicitud ha sido eliminada.', updated: 'La solicitud ha sido actualizada.', created: 'Se ha registrado una nueva solicitud.' },
      },
      dashboard: {
        greeting: 'Hola,',
        dueNotice: 'Cuota de Mantenimiento Pendiente: {{amount}}',
      },
      community: {
        title: 'Comunidad',
        actions: { newPostPlus: '+ Crear Nueva Publicación', publish: 'Publicar' },
        form: { newTitle: 'Nueva Publicación', titlePlaceholder: 'Título', contentPlaceholder: 'Escriba el contenido aquí.' },
        list: { title: 'Lista de Publicaciones', author: 'Autor', category: 'Categoría' },
        errors: { loadFailed: 'No se pudo cargar la lista de publicaciones.', createFailed: 'Falló el registro de la publicación.' },
        success: { created: 'La publicación ha sido registrada.' },
      },
      maintenance: {
        title: 'Reporte de Problemas y Mantenimiento',
        actions: { newReportPlus: '+ Reportar Nuevo Problema', submit: 'Enviar Reporte' },
        form: { newTitle: 'Reportar Nuevo Problema', typeLabel: 'Tipo de Problema', detailLabel: 'Descripción Detallada', detailPlaceholder: 'Describa el problema en detalle.' },
        list: { title: 'Estado de Mis Solicitudes' },
        errors: { loadFailed: 'No se pudo cargar la lista de solicitudes.', createFailed: 'Falló el registro de la solicitud.' },
        success: { received: 'Se ha recibido la solicitud de mantenimiento.' },
      },
      payment: {
        title: 'Pagos y Facturación',
        loadingBills: 'Cargando facturas...',
        due: 'Vence',
        detailTitle: 'Detalle de la Factura',
        table: { month: 'Mes de cobro', status: 'Estado', item: 'Ítem', amount: 'Monto', total: 'Total' },
        actions: { detail: 'Detalle', receipt: 'Recibo', mockPay: 'Pagar (Simulado)', receiptPdf: 'Recibo PDF' },
        errors: { loadBillsFailed: 'No se pudo cargar las facturas' },
        success: { mockPaid: 'Pago simulado completado.' },
      },
      profile: {
        title: 'Perfil y Configuración',
        sections: { accountInfo: 'Información de la Cuenta', unitInfo: 'Información de la Unidad' },
        info: { username: 'Nombre', sessionEmail: 'Correo de Sesión', role: 'Rol' },
        form: { username: 'Nombre', email: 'Correo Electrónico' },
        actions: { save: 'Guardar', saving: 'Guardando...', logout: 'Cerrar Sesión' },
        errors: { saveFailed: 'Error al guardar el perfil.' },
        success: { updated: 'El perfil ha sido actualizado exitosamente.' },
        unit: { building: 'Torre', unit: 'Apartamento' },
      },
      reservation: {
        title: 'Reserva de Áreas Comunes',
        availableFacilities: 'Instalaciones Disponibles',
        myReservations: 'Mis Reservas',
        actions: { reserve: 'Reservar', request: 'Solicitar Reserva', cancel: 'Cancelar Reserva' },
        modal: { title: 'Reservar {{name}}', selectDate: 'Seleccionar Fecha', selectTime: 'Seleccionar Hora', unavailable: 'No disponible', availabilityNote: 'Disponibilidad basada en tus reservas. Puede variar.' },
        errors: { loadFailed: 'No se pudieron cargar los datos de reserva.', selectDate: 'Por favor, seleccione una fecha.', createFailed: 'No se pudo crear la reserva.', cancelFailed: 'No se pudo cancelar la reserva.' },
        success: { requested: 'La solicitud de reserva para {{name}} ha sido enviada.', canceled: 'La reserva ha sido cancelada.' },
        confirmCancel: '¿Está seguro de que desea cancelar esta reserva?',
      },
    },
  },
};

const lng = getDefaultLocale();
try { localStorage.setItem(STORAGE_KEY, lng); } catch (e) {}

i18n
  .use(initReactI18next)
  .init({
    resources,
    lng,
    fallbackLng: 'en',
    interpolation: { escapeValue: false },
  });

export const setLocale = (nextLng) => {
  i18n.changeLanguage(nextLng);
  try { localStorage.setItem(STORAGE_KEY, nextLng); } catch (e) {}
};

export default i18n;

